# 通信协议

> 物联网通信的特点：无线、低速、低功耗

## 概述

### 典型协议

- IEEE 802.15.4：2003年10月, 由IEEE发布，覆盖低速无线个域网的物理层和MAC 层
- ZigBee：“紫蜂”，2004年诞生，是基于IEEE 802.15.4 标准的低功耗短距离无线网络协议
- 传感网协议：由大量低功耗节点组成的无线自组织多跳网络，实时感知、处理和传输网络覆盖区域内监测对象的信息
- BLE：1994年，蓝牙技术由爱立信公司推出，目标是在移动电话和其他配件间进行低功耗、低成本无线通信连接
- RFID：射频识别, 无线电的信号是通过调成无线电频率的电磁场，把数据从附着在物品上的标签上传送出去，以自动辨识与追踪该物品
- NFC：近场通信技术，2004年由飞利浦半导体、诺基亚和索尼共同研制开发，是一种短距高频的无线电技术，在13.56 MHz频率运行于20厘米距离内，由RFID演变而来
- THREAD：针对IEEE 802.15.4设备设计的IPv6网络协议栈

### 功耗与通信距离

!!!note D(dbm)和P(mw)换算
    $D=10lgP $，所以dbm可以为0，甚至为负

嵌入式设备的功耗很大部分来源于通信功耗，所以需要降低无线收发器占空比。

常用的路径损耗模型公式为$PL(d)=PL_0+10n\log(\frac{d}{d_0})+X_{\delta} $，其中：

- $PL_0 $：传输$d_0 $（一般为1m）的路径损耗
- $n $：衰减指数
- $X_{\delta} $：高斯随机误差

最远通信距离$RSSI=P_{tx}+P_{ta}+P_{ra}-PL(d) $，其中：

- $P_{tx} $：发射功率
- $P_{ta},P_{ra} $：发射、接收天线增益

### 频段与数据率

- 授权频段：使用需要许可证，比如AM，FM
- ISM频段：主要开放给工业、科学和医疗机构使用，无需许可证或费用

实际数据率与最大数据率之间有较大差距，主要是因为退避时间和数据包头部，实际的传输效率为$\eta=\frac{数据载荷的传输时间}{退避时间+数据包头部传输时间+数据载荷传输时间} $


## 基于IEEE802.15.4的传感网协议

传感网协议的典型使用场景: 自组织无线多跳网络

<img src="images/layer.png" width=400px>

- 物理层：从比特流到RF信号
  - DSSS 扩频：每4bit数据转化为32位码片(chips)
  - O-QPSK调制：将32位码元序列调制到信号的I和Q相位上
  - 脉冲成形
  - 数模转换及信号发送


