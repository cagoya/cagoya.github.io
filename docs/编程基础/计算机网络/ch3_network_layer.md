# 网络层

## 功能

### 简介

网络层提供主机到主机的通信服务，主要任务是将分组从源主机经过多个网络和多段链路传输到目的主机。该任务可划分为分组转发和路由选择两种重要功能。在互联网所采用的TCP/IP体系结构中，网络层向上只提供简单的、无连接的、尽最大努力交付的数据报服务。也就是说，所传送的分组可能出错、丢失、重复、失序或超时，这就使得网络中的路由器可以做的比较简单，而且价格低廉。

### 异构网络连接

!!!note
    由于历史原因，我们往往也把网络层的路由器称为网关。

互联网是全球范围内数以百万计的异构网络互连起来的。这些网络的拓扑结构、寻址方案、差错处理方法、路由选择机制等都不尽相同。网络层要完成的任务之一就是实现这些异构网络的互连。网络互连是指将两个以上的计算机网络，通过一定方法，用一些中继系统相互连接起来，以构成更大的网络系统。根据所在的层次，中继系统分以下4种：

1. 物理层：转发器、集线器
2. 数据链路层：网桥或交换机
3. 网络层：路由器
4. 网络层以上：网关

当使用物理层和数据链路层的中继系统时，只是把一个网络扩大了，而从网络层的角度看，它仍是同一个网络，一般并不称为网络互连。因此，网络互联通常是指路由器进行网络连接和路由选择。**路由器是一台专用计算机**，用于在互联网中进行路由选择。

IP 抹除了不同网络的差异，当IP网上的主机进行通信时，就好像在单个网络上通信一样，而看不见互连的各个网络的具体异构细节。

### 路由与转发

路由器主要完成两个功能，一个是路由选择（确定哪一条路径），二是分组转发（当一个分组到达时所采取的动作）。前者根据路由选择协议并构造路由表，后者处理通过路由器的数据流，关键操作是转发表查询、转发及相关的队列管理和任务调度等。